# TSAuto 问题列表与优先级

## 优先级说明
- **P0**：紧急，影响核心功能正常运行
- **P1**：高优先级，影响核心玩法体验
- **P2**：中优先级，影响系统稳定性或扩展性
- **P3**：低优先级，优化或改进建议

## 问题列表

### P0 - 紧急问题

1. **BattleEngine 战斗结果处理逻辑错误**
   - **问题**：`checkBattleResult` 方法在设置战斗结果后立即将 `isRunning` 设为 `false`，可能导致后续战斗逻辑无法执行
   - **位置**：`src/core/battle/BattleEngine.ts:682`
   - **影响**：战斗可能提前结束，无法正常完成所有战斗流程

2. **状态效果属性加成未实际应用**
   - **问题**：`processStatusEffects` 方法只是打印日志，没有实际应用状态效果的属性加成
   - **位置**：`src/core/battle/BattleEngine.ts:553-557`
   - **影响**：所有状态效果的属性加成无法生效，影响战斗平衡性

### P1 - 高优先级问题

3. **BattleEngine 回合数计算错误**
   - **问题**：战斗循环中，每处理一个角色行动就推进回合数，而不是每轮所有角色行动完后推进
   - **位置**：`src/core/battle/BattleEngine.ts:168`
   - **影响**：回合数增长过快，影响基于回合数的状态效果和战斗逻辑

4. **缺少 Gambit 自定义AI系统**
   - **问题**：缺少文档中列为核心玩法的 Gambit 自定义AI系统
   - **影响**：无法实现核心玩法，玩家体验受限

5. **缺少精力值系统**
   - **问题**：缺少文档中设计的精力值系统，无法限制角色出战频率
   - **影响**：无法实现核心的角色轮换机制，影响游戏策略性

6. **插件加载器路径问题**
   - **问题**：插件加载器的动态加载路径可能存在问题（`../../../../plugins/`）
   - **位置**：`src/core/plugin/PluginLoader.ts:180`
   - **影响**：插件可能无法正确加载，影响游戏内容扩展性

### P2 - 中优先级问题

7. **目录结构与文档不符**
   - **问题**：
     - 插件系统目录应为 `src/core/plugin-system/`，实际为 `src/core/plugin/`
     - 存在 `src/ui/` 和 `src/ui-react/` 两个UI相关目录，与文档设计不符
   - **影响**：代码结构混乱，影响后续开发和维护

8. **TurnManager 速度计算逻辑简单**
   - **问题**：
     - `getSpeedBuffs` 方法只处理了 `SPD_UP` 类型的buff
     - 速度计算逻辑相对简单，可能无法处理复杂的速度加成情况
   - **位置**：`src/core/battle/TurnManager.ts:136-158`
   - **影响**：无法处理复杂的速度加成情况，影响战斗策略性

9. **DamageCalculator 计算逻辑问题**
   - **问题**：
     - 使用 `Math.round` 而不是 `Math.floor` 进行伤害计算
     - 属性计算逻辑相对简单，可能无法处理复杂的属性加成情况
   - **位置**：`src/core/battle/DamageCalculator.ts:80, 196`
   - **影响**：伤害计算结果与预期不符，影响战斗平衡性

10. **缺少专门的属性计算系统**
    - **问题**：缺少专门的属性计算系统来处理所有加成
    - **影响**：属性加成计算分散在各个模块，难以维护和扩展

### P3 - 低优先级问题

11. **缺少 Roguelike 构筑元素**
    - **问题**：缺少文档中设计的 Roguelike 构筑元素
    - **影响**：无法实现完整的游戏玩法循环

12. **缺少御魂重铸与保底系统**
    - **问题**：缺少文档中设计的御魂重铸与保底系统
    - **影响**：无法实现完整的装备养成系统

13. **静态插件生成文件管理**
    - **问题**：`static-plugins.generated.ts` 的生成逻辑需要检查
    - **位置**：`src/core/plugin/static-plugins.generated.ts`
    - **影响**：静态插件的生成和管理可能存在问题

14. **灵玉五行系统与文档不符**
    - **问题**：灵玉五行系统的实现与文档可能存在出入（用户已说明）
    - **影响**：文档与实际实现不一致，影响后续开发和测试

15. **部分接口定义与实际实现不完全匹配**
    - **问题**：部分接口定义与实际实现不完全匹配
    - **影响**：代码类型安全性降低，可能导致运行时错误

## 建议修复顺序

1. 优先修复 P0 级别的紧急问题，确保核心功能正常运行
2. 其次修复 P1 级别的高优先级问题，确保核心玩法体验
3. 然后修复 P2 级别的中优先级问题，提高系统稳定性和扩展性
4. 最后考虑 P3 级别的低优先级问题，优化游戏体验

## 备注

- 本问题列表基于对 `TSAuto策划及技术设计文档.md` 和核心代码的对比分析
- 部分问题可能在后续开发中被调整或修改
- 建议定期更新本问题列表，确保与最新的代码状态保持一致